<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Configuration &mdash; perfSONAR Toolkit 4.1.5 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/perfsonar.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4.1.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="perfSONAR Toolkit 4.1.5 documentation" href="index.html" />
    <link rel="up" title="pSConfig Web Admin" href="pwa.html" />
    <link rel="next" title="User Management" href="pwa_user_management.html" />
    <link rel="prev" title="Installation" href="pwa_install.html" /> 
  </head>
  <body>
    <header>
        <div class="headerContents">
          <a href="index.html" border="0"><img src="_static/perfSONAR-header.gif"></a>
          <div class="acctSearchContainer">
              <section id="searchBox" class="searchBox">
                  <!--Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
                  <!--The terms of service are available at http://www.google.com/cse/docs/tos.html -->
                  <form action="search.html" id="cse-search-box" method="get">
                    <input type="text" name="q" size="25" class="searchInput" placeholder="Search"/>
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                  </form>
              </section>
         </div>
        </div>
    </header>
    <div style="display:block;clear:both;">
    
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="pwa_user_management.html" title="User Management"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pwa_install.html" title="Installation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">perfSONAR Toolkit 4.1.5 documentation</a> &raquo;</li>
          <li><a href="pwa.html" accesskey="U">pSConfig Web Admin</a> &raquo;</li> 
      </ul>
    </div>
    </div>
    
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h1>
<p>Most of the configuration files for PWA can be found in the <tt class="docutils literal"><span class="pre">/etc/pwa</span></tt> directory. At a minimum, you need to configure the datasources for your instance, configure the authentication module, and create a user before you can start using PWA.</p>
<p><strong>Note:</strong> If you are upgrading from an old MCA instance, view the docs on <a class="reference external" href="pwa_upgrading_from_mca">Upgrading from MCA to PWA</a></p>
<div class="section" id="data-sources">
<h2>Data Sources<a class="headerlink" href="#data-sources" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">/etc/pwa/index.js</span></tt> lists the Global Lookup Service and any private LSes that host information is pulled from.</p>
<div class="section" id="global-sls">
<h3>Global SLS<a class="headerlink" href="#global-sls" title="Permalink to this headline">¶</a></h3>
<p>A sample datasource entry for the Global SLS:</p>
<div class="highlight-python"><div class="highlight"><pre>&quot;gls&quot;: {
    label: &#39;GLS&#39;,
    type: &#39;global-sls&#39;,
    activehosts_url: &#39;http://ps1.es.net:8096/lookup/activehosts.json&#39;,
    query: &#39;?type=service&#39;,
},
</pre></div>
</div>
<ul class="simple">
<li>&#8220;gls&#8221; is used as internal key to identify this datasource. Pick one that&#8217;s unique.</li>
<li>label: is used to show the datasource name in the web UI</li>
<li>type: needs to be &#8220;global-sls&#8221; for Global SLS datasource.</li>
<li>activehosts_url: should always point to <a class="reference external" href="http://ps1.es.net:8096/lookup/activehosts.json">http://ps1.es.net:8096/lookup/activehosts.json</a> unless you know a different global registry.</li>
<li>query: This query is passed to all sLS instances that are member of the global registry. You will always want <tt class="docutils literal"><span class="pre">?type=service</span></tt>, at the very least. For more detail on sLS query, see below.</li>
</ul>
</div>
<div class="section" id="global-sls-filtered">
<h3>Global SLS, filtered<a class="headerlink" href="#global-sls-filtered" title="Permalink to this headline">¶</a></h3>
<p>You can define a query for the SLS instance, so if you want host datasources set differently depending on what communities they are in (or other parameters), you can do so.</p>
<p>A sample of filtered Global SLS datasource:</p>
<div class="highlight-python"><div class="highlight"><pre>&quot;osg&quot;: {
    label: &#39;OSG&#39;,
    type: &#39;global-sls&#39;,
    activehosts_url: &#39;http://ps1.es.net:8096/lookup/activehosts.json&#39;,
    query: &#39;?type=service&amp;group-communities=OSG&#39;,
},
</pre></div>
</div>
<ul class="simple">
<li>&#8220;osg&#8221; is used as internal key to identify this datasource. Pick one that&#8217;s unique.</li>
<li>label: is used to show the datasource name in the web UI</li>
<li>type: needs to be &#8220;global-sls&#8221; for Global SLS datasource.</li>
<li>activehosts_url: should always point to <a class="reference external" href="http://ps1.es.net:8096/lookup/activehosts.json">http://ps1.es.net:8096/lookup/activehosts.json</a> unless you know a different global registry.</li>
<li>query: This query is passed to all sLS instances that are member of the global registry. For more detail on sLS query, please refer to <a class="reference external" href="https://github.com/esnet/simple-lookup-service/wiki/APISpec#query">sLS API Spec</a></li>
</ul>
<p>So, the above sample datasource entry instructs mca-cache service to pull all service records (used to construct &#8220;hosts&#8221; for PWA) from the global lookup service (ps1.es.net) with community registered to &#8220;OSG&#8221;. If you don&#8217;t want any hosts from OSG, simply remove this section, or update the label and group-communities to something other than OSG.</p>
<p>As you may find in the default <tt class="docutils literal"><span class="pre">/etc/pwa/index.js</span></tt>, you can list as many datasources as you want. Make sure to use a unique key, and label.</p>
</div>
<div class="section" id="sls">
<h3>sLS<a class="headerlink" href="#sls" title="Permalink to this headline">¶</a></h3>
<p>If you have a private sLS instance, enter something like following, replacing <tt class="docutils literal"><span class="pre">sls_hostname</span></tt> with your sLS hostname:</p>
<div class="highlight-python"><div class="highlight"><pre>&quot;wlcg&quot;: {
    label: &#39;WLCG&#39;,
    type: &#39;sls&#39;,
    url: &#39;https://sls_hostname/sls/lookup/records/?type=service&amp;group-communities=WLCG&#39;,
    cache: 1000*60*5, //refresh every 5 minutes (default 30 minutes)
},
</pre></div>
</div>
<ul class="simple">
<li>&#8220;wlcg&#8221; is used as internal key to identify this datasource. Pick one that&#8217;s unique</li>
<li>label: is used to show the datasource name in the web UI</li>
<li>type: needs to be &#8216;sls&#8217;</li>
<li>url: URL for your private sLS instance. For type off queries, please refer to <a class="reference external" href="https://github.com/esnet/simple-lookup-service/wiki/APISpec#query">sLS API Spec</a></li>
<li>cache: refrequency of polling from this sLS in msec.</li>
</ul>
<p>When you update this file, all PWA services will automatically restart. Please monitor logs by doing <tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">docker</span> <span class="pre">exec</span> <span class="pre">-it</span> <span class="pre">pwa-admin1</span> <span class="pre">pm2</span> <span class="pre">logs</span></tt></p>
</div>
</div>
<div class="section" id="database">
<h2>Database<a class="headerlink" href="#database" title="Permalink to this headline">¶</a></h2>
<p>The database is also configured in <tt class="docutils literal"><span class="pre">/etc/pwa/index.js</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">exports</span><span class="o">.</span><span class="n">mongodb</span> <span class="o">=</span> <span class="s">&quot;mongodb://mongo/pwa&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>When you update this file, all meshconfig services will automatically restart. Please monitor logs by doing  <tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">docker</span> <span class="pre">exec</span> <span class="pre">-it</span> <span class="pre">pwa-admin1</span> <span class="pre">pm2</span> <span class="pre">logs</span></tt></p>
</div>
<div class="section" id="test-spec-default-parameters">
<h2>Test Spec Default parameters<a class="headerlink" href="#test-spec-default-parameters" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">index.js</span></tt> contains default values for various test specification. Update this to your liking (please send us comments if we should be using a different default).</p>
<p>When you update this file, all meshconfig services will automatically restarts. Please monitor logs by doing <tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">docker</span> <span class="pre">exec</span> <span class="pre">-it</span> <span class="pre">pwa-admin1</span> <span class="pre">pm2</span> <span class="pre">logs</span></tt></p>
</div>
<div class="section" id="logging">
<h2>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">index.js</span></tt> also contains logging related configuration. It&#8217;s unlikely you need to change this, but if you want to  enable debug logging, for instance, you would change:</p>
<p><tt class="docutils literal"><span class="pre">level:</span> <span class="pre">'info',</span></tt></p>
<p>to</p>
<p><tt class="docutils literal"><span class="pre">level:</span> <span class="pre">'debug',</span></tt></p>
<p>PWA uses Winston for logging. Please see <a class="reference external" href="https://github.com/winstonjs/winston">Winston</a> for more detail.</p>
</div>
<div class="section" id="others">
<h2>Others<a class="headerlink" href="#others" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">index.js</span></tt> contains all other configuration such as ports and host names to bind PWA server and PWA publisher. It also contain information such as the location of JWT public key to verify token issued by SCA authentication service.</p>
</div>
<div class="section" id="authentication-service-sca-auth">
<h2>Authentication Service (sca-auth)<a class="headerlink" href="#authentication-service-sca-auth" title="Permalink to this headline">¶</a></h2>
<p>PWA uses authentication microservices originally developed by SCA (Scalable Computing Archive) group at IU. You can enable / disable various authentication methods provided by sca-auth by modifying <tt class="docutils literal"><span class="pre">/etc/pwa/auth/index.js</span></tt></p>
<p>Certain features in PWA are restricted to only super-admin. In order to become a super-admin, you will need to run following as root via the command line.</p>
<div class="highlight-python"><div class="highlight"><pre>docker exec -it sca-auth /app/bin/auth.js modscope --username user --add &#39;{&quot;pwa&quot;: [&quot;admin&quot;]}&#39;
</pre></div>
</div>
<p>You need to sign out &amp; login again in order for this change to take effect.</p>
<p>Please refer to <a class="reference external" href="https://github.com/perfsonar/sca-auth">sca-auth gitrepo</a> for more information.</p>
</div>
<div class="section" id="user-management">
<h2>User Management<a class="headerlink" href="#user-management" title="Permalink to this headline">¶</a></h2>
<p>By default, signup is disabled and no users exist. You will need either manually create users (see the next page for details), and/or allow signups</p>
<p>To enable user signup (registration through the web form), set these values in the following files:</p>
<p><tt class="docutils literal"><span class="pre">/etc/pwa/auth/index.js</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre>allow_signup: true
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">/etc/pwa/shared/auth.ui.js</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre>signup: true
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <nav id="channelNav" class="channelNav">
                
                <ul>
<li><a class="reference internal" href="#">Configuration</a><ul>
<li><a class="reference internal" href="#data-sources">Data Sources</a><ul>
<li><a class="reference internal" href="#global-sls">Global SLS</a></li>
<li><a class="reference internal" href="#global-sls-filtered">Global SLS, filtered</a></li>
<li><a class="reference internal" href="#sls">sLS</a></li>
</ul>
</li>
<li><a class="reference internal" href="#database">Database</a></li>
<li><a class="reference internal" href="#test-spec-default-parameters">Test Spec Default parameters</a></li>
<li><a class="reference internal" href="#logging">Logging</a></li>
<li><a class="reference internal" href="#others">Others</a></li>
<li><a class="reference internal" href="#authentication-service-sca-auth">Authentication Service (sca-auth)</a></li>
<li><a class="reference internal" href="#user-management">User Management</a></li>
</ul>
</li>
</ul>

                <ul>
                  <li>
                  <a href="pwa_install.html">Previous topic</a>
                  <ul><li><a href="pwa_install.html" title="previous chapter">Installation</a></li></ul>
                  </li>
                </ul>
                  <ul>
                      <li>
                      <a href="pwa_user_management.html">Next topic</a>
                      <ul><li><a href="pwa_user_management.html" title="next chapter">User Management</a></li></ul>
                      </li>
                  </ul>
                
                
            </nav>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="pwa_user_management.html" title="User Management"
             >next</a> |</li>
        <li class="right" >
          <a href="pwa_install.html" title="Installation"
             >previous</a> |</li>
        <li><a href="index.html">perfSONAR Toolkit 4.1.5 documentation</a> &raquo;</li>
          <li><a href="pwa.html" >pSConfig Web Admin</a> &raquo;</li> 
      </ul>
    </div>
    <footer id="fat">
        <div class="footerContents">
            <nav id="fatFooterNav" class="fatFooterNav">
                <ul id="menu-partners" class="menu depth-0">
                    <li id="footer-partner-text" class="partner-menu">
                        perfSONAR 
                        <br>
                        partners 
                        <br>
                        include: 
                    </li>
    
                <li id="footer-partner-esnet" class="partner-menu">
                    <a href="http://www.es.net/" title="Visit DOE's Energy Sciences Network"><img src="_static/ESnet-ps.png" alt="" style="border:none;"></a> </li>
                
                <li id="footer-partner-geant" class="partner-menu">
                    <a href="http://www.geant.org/" title="Visit GEANT"><img src="_static/geant-ps.png" alt="" style="border:none;"/></a> </li>
        
                <li id="footer-partner-iu" class="partner-menu">
                    <a href="http://www.iu.edu/" title="Visit Indiana University"><img src="_static/IU-ps.png" alt="" style="border:none;"></a> </li>

                <li id="footer-partner-i2" class="partner-menu">
                    <a href="http://www.internet2.edu/" title="Visit Internet2"><img src="_static/I2-ps.png" alt="" style="border:none;"></a> </li>
                
                <li id="footer-partner-um" class="partner-menu">
                    <a href="http://www.umich.edu/" title="Visit University of Michigan"><img src="_static/UM-ps.png" alt="" style="border:none;"></a> </li>

                </ul>

            </nav>
            <nav id="minFooterNav" class="minFooterNav">
                <span class="copyright">PERFormance Service Oriented Network monitoring ARchitecture </span>
            </nav>
          
        </div> <!-- /footerContents -->
    </footer>
    
    <div class="footer">
        &copy; Copyright 2019, perfSONAR Project.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>